/*!
 *version:0.1.12,
 *author:hezedu,
 *Released: jQuery.Released,
 *Date:2015-2-8
*/
function sas(e,t){function n(s,p,u,o){function c(r,a,l,s){l[0]===l[1]?s?(s[2][1]++,c.apply(null,s)):t.allEnd&&t.allEnd(null,e):"number"==typeof r&&n(l[1],a,l,s)}function f(e,f){if(l++,!r){switch(e){case"$STOP":return t.allEnd&&t.allEnd("$STOP"),r=!0;case"$THIS=":o&&(o[1][o[0]]=f),u[1]=u[0];break;case"$END":u[1]=u[0];break;case"$RELOAD":return p[s]=f,n.apply(null,m);default:if(u[1]++,arguments.length<2)p[s]=e;else{for(var i=[],h=0,g=arguments.length;g>h;h++)i.push(arguments[h]);p[s]=i}}t.process&&t.process(a,l),c.apply(null,m)}}if(!r){var i=Object.prototype.toString.call(p[s]).slice(8,-1);switch(i){case"Object":for(var h=Object.keys(p[s]),g=h.length,b=[g,0],d=0;g>d;d++)n(h[d],p[s],b,arguments);break;case"Array":var b=[p[s].length,0];n(b[1],p[s],b,arguments);break;case"Function":a++;var m=arguments;if(p[s].length>1){var y,v={index:s,path:[s]},E=0,S=!1;if(o)for(y=o,v.parent=o[1],v.pIndex=o[0];y;)E++,S||"number"!=typeof y[0]||(v.Sparent=y[1],S=!0),v.path.splice(0,0,y[0]),y=y[3];v.push=function(t){u[0]++,v.parent?v.parent[v.pIndex].push(t):e.push(t)},v.fspath=function(){for(var e=[],t=this.path,n=0,r=t.length;r>n;n++)"string"==typeof t[n]&&e.push(t[n]);return e},p[s](f,v)}else p[s](f);break;default:if(!t.iterator)throw new Error("SAS:类型错误:"+i+"。 任务必须是一个function。");p[s]=t.iterator(p[s]),n.apply(null,arguments)}}}t=t||{};var r=!1,a=0,l=0,s=[e.length,0];n(s[1],e,s)}"object"==typeof module&&"object"==typeof module.exports&&(module.exports=sas);